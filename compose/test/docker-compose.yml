version: "2.0"

services:
  api:
    build:
      context: ../../api
    ports:
        - "3001:3000"
  web:
    build:
      context: ../../web
    command: yarn serve --mode=production
    ports:
        - "8081:8080"
    depends_on:
        - api
  e2e:
    build:
      context: ../../web
    command: bash -c "curl http://api:3000 && yarn test:e2e --headless"
    volumes:
        - '../../web/tests/e2e/screenshots:/app/tests/e2e/screenshots'
        - '../../web/tests/e2e/videos:/app/tests/e2e/videos'
    depends_on:
        - api
